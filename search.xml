<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[Normality Experiment for Equities Time-Series]]></title>
    <url>%2F2018%2F04%2F04%2Fnormal-test%2F</url>
    <content type="text"><![CDATA[IntroWhen working with equities time series data, a natural question arises about the normality of equities’ data. In theory, stocks market assumes to be normally distributed. However, in reality, equities’ data is much more messy than our normally distributed assumption. In this post, I take an empirical approach to examine normality assumption of historical equities’ data under different time frequencies. Procedure &amp; CodeLoad packages123456library(quantmod)library(zoo)library(xts)library(ggplot2)library(scales)library(psych) Symbols Lookup12SymbolsLookup = stockSymbols(exchange = &quot;NASDAQ&quot;)head(SymbolsLookup, 20) This stockSymbols is a r function can be easily used to lookup basic companies info and their tickers for later use. Equities Returns Data Gathering123456789101112131415161718Symbols &lt;- c(&quot;XOM&quot;,&quot;MSFT&quot;,&quot;JNJ&quot;,&quot;GE&quot;,&quot;CVX&quot;,&quot;WFC&quot;,&quot;JPM&quot;,&quot;VZ&quot;,&quot;PFE&quot;, &quot;T&quot;,&quot;IBM&quot;,&quot;MRK&quot;,&quot;BAC&quot;,&quot;DIS&quot;,&quot;ORCL&quot;,&quot;INTC&quot;,&quot;SLB&quot;)Data &lt;- new.env()getSymbols(c(&quot;^GSPC&quot;, Symbols), from = &quot;1989-01-01&quot;, env = Data)# eapply: apply a function over values in an enivronment# ROC: calculate rate of change over a series# Ad: extract adjust return from OHLC time-seriesReturns &lt;- eapply(Data, function(s) ROC(Ad(s), type=&quot;discrete&quot;))# do.call: execute a function call do.call(function , arguments)ReturnsDF &lt;- as.data.frame(do.call(merge, Returns))# remove .Adjusted in the column names and re-order by ticker symbol# provided abovecolnames(ReturnsDF) &lt;- gsub(&quot;.Adjusted&quot;,&quot;&quot;,colnames(ReturnsDF))ReturnsDF &lt;- ReturnsDF[,c(&quot;GSPC&quot;,Symbols)] In this case, I choose 17 companies’ stocks along with S&amp;P index. Securities’ returns are calculated based on adjusted closed prices. Wrangling dataDaily12345678910111213date &lt;- as.Date(rownames(ReturnsDF))df &lt;- data.frame(date = date, ret = ReturnsDF$GSPC)#plotggplot(df, aes(x = date, y =ret)) + geom_line(aes(colour= &quot;Return&quot;)) + geom_hline(yintercept = 0.03) + geom_hline(yintercept = -0.03) + xlab(&quot;Date&quot;) + ylab(&quot;Return&quot;) + ggtitle(&quot;S&amp;P Daily Return with 3-std Marks&quot;)# statistics about daily datadescribe(ReturnsDF, type = 1) By using S&amp;P daily return as an exmpale, it can be observed that historical return does not follow the normally distributed assumption. Instead, it shows a fat tail phenomenon. The fluctuations in S&amp;P returns often excess 3 standard derivations. If we zoom in near year 2008 (yeah, the financial crisis), a abnormally huge return fluctuations showed up in the graph.12# statistics about daily datadescribe(ReturnsDF, type = 1) Also, let’s take a look at all securities statistical summaries, especially focus on measurements of skewness and kurtosis. Notice, non-zero skewness measurements accross most of equities indicate non-symmetric feature in the empirical return data. Large excess kurtosis measurements accross all equities emphasize “fat-tail” feature in the empirical return. In summary, both skewness and excess kurtosis measurements for selected securities suggested that daily return does not follow an normal distribution, therefore the normality assumption fails. Weekly, Monthly and Annually12345678910111213141516171819202122232425262728293031323334353637383940414243444546Return_daily &lt;- ReturnsDFReturn_daily &lt;- Return_daily[-1,]rownames(Return_daily) &lt;- as.Date(rownames(Return_daily))daily_xts &lt;- as.xts(Return_daily)daily_xts &lt;- daily_xts + 1# weeklyweekly_xts &lt;- apply.weekly(daily_xts , function(x) apply(x,2, prod)) - 1date &lt;- index(weekly_xts)df &lt;- data.frame(date = date, ret = weekly_xts$GSPC)ggplot(df, aes(x = date, y = GSPC)) + geom_line(aes(colour= &quot;Return&quot;)) + geom_hline(yintercept = 0.06) + geom_hline(yintercept = -0.06) + xlab(&quot;Date&quot;) + ylab(&quot;Return&quot;) + ggtitle(&quot;S&amp;P Weekly Return with 3-std Marks&quot;)describe(weekly_xts, type = 1)# monthlymonthly_xts &lt;- apply.monthly(daily_xts , function(x) apply(x,2, prod)) - 1date &lt;- index(monthly_xts)df &lt;- data.frame(date = date, ret = monthly_xts$GSPC)ggplot(df, aes(x = date, y =GSPC)) + geom_line(aes(colour= &quot;Return&quot;)) + geom_hline(yintercept = 0.12) + geom_hline(yintercept = -0.12) + xlab(&quot;Date&quot;) + ylab(&quot;Return&quot;) + ggtitle(&quot;S&amp;P Monthly Return with 3-std Marks&quot;)describe(monthly_xts, type = 1)# annuallyyearly_xts &lt;- apply.yearly(daily_xts , function(x) apply(x,2, prod)) - 1date &lt;- index(yearly_xts)df &lt;- data.frame(date = date, ret = yearly_xts$GSPC)ggplot(df, aes(x = date, y =GSPC)) + geom_line(aes(colour= &quot;Return&quot;)) + geom_hline(yintercept = 0.51) + geom_hline(yintercept = -0.51) + xlab(&quot;Date&quot;) + ylab(&quot;Return&quot;) + ggtitle(&quot;S&amp;P Annually Return with 3-std Marks&quot;)describe(yearly_xts) Weekly Monthly Annually A clear statemnet can be made from direct observation of results above, as time frequency decrease (time horizon increase), the equities time series data behave more “normally”. Skewness measurements do not change much over different time horizon, which still suggested non-symmetric feature in the data, but excess kurtosis measurements moving toward 0 as time frequency decrease. ConclusionOne take away from this normality experiment is equities time series data behave differently under various time frequencies. In general, equities time series data approach “normality” as time frequency decrease. Keep in mind that the time horizon play an important role in data normality, you may need to consider this in order to choose the proper time horizon for your works.]]></content>
      <categories>
        <category>P-Quant</category>
        <category>Asset Management</category>
      </categories>
      <tags>
        <tag>r</tag>
        <tag>time series</tag>
        <tag>equities</tag>
      </tags>
  </entry>
</search>
